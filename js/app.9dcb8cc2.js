(function(t){function e(e){for(var o,i,r=e[0],c=e[1],l=e[2],h=0,d=[];h<r.length;h++)i=r[h],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);u&&u(e);while(d.length)d.shift()();return n.push.apply(n,l||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],o=!0,r=1;r<s.length;r++){var c=s[r];0!==a[c]&&(o=!1)}o&&(n.splice(e--,1),t=i(i.s=s[0]))}return t}var o={},a={app:0},n=[];function i(e){if(o[e])return o[e].exports;var s=o[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=o,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},1:function(t,e){},1309:function(t,e,s){},2:function(t,e){},3:function(t,e){},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var o=s("2b0e"),a=s("2222"),n=s.n(a),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},r=[],c=s("2877"),l={},u=Object(c["a"])(l,i,r,!1,null,null,null),h=u.exports,d=(s("b0c0"),s("a4d3"),s("e01a"),s("2f62")),p=s("d4ec"),f=s("bee2"),m=(s("a434"),s("ac1f"),function(){function t(e){Object(p["a"])(this,t),this.limit=e,this.history=[],this.current=0}return Object(f["a"])(t,[{key:"add",value:function(t){this.history.splice(this.current,this.history.length),this.history.length>=this.limit&&this.history.shift(),this.history.push(t),this.current=this.history.length,localStorage.vdarw=n.a.project.exportJSON()}},{key:"undo",value:function(){this.canUndo()&&this.history[--this.current].unexec()}},{key:"redo",value:function(){this.canRedo()&&this.history[this.current++].exec()}},{key:"canUndo",value:function(){return this.current>0}},{key:"canRedo",value:function(){return this.history.length>this.current}},{key:"clear",value:function(){this.history=[],this.current=0,localStorage.vdarw="[]"}}]),t}()),v=new m(20),g=s("2909"),b=s("4c17"),w=s.n(b),y=function(){function t(e){var s=e.path;Object(p["a"])(this,t),this._args={path:s},s.name=w()()}return Object(f["a"])(t,[{key:"exec",value:function(){var t;this.removed&&(t=this._args.path).add.apply(t,Object(g["a"])(this.removed))}},{key:"unexec",value:function(){this.removed=this._args.path.removeSegments()}}]),t}(),k={path:null,show:null},C={lastSize:0,lastColor:"#00000FF"},$=function(t){k.show&&k.show.layer===n.a.project.activeLayer&&C.lastSize===Y.state.pencilArgs.size&&C.lastColor===Y.state.pencilArgs.color||(k.show&&k.show.remove(),k.show=null,k.show=new n.a.Path.Circle({center:[0,0],radius:Y.state.pencilArgs.size/2,fillColor:Y.state.pencilArgs.color}),C.lastSize=Y.state.pencilArgs.size,C.lastColor=Y.state.pencilArgs.color),k.show.position=t.point},x=function(t){k.path=new n.a.Path,k.path.strokeColor=Y.state.pencilArgs.color,k.path.strokeWidth=Y.state.pencilArgs.size,k.path.strokeCap="round",k.path.strokeJoin="round",k.path.add(t.point)},S=function(t){k.path&&k.path.add(t.point)},j=function(t){k.path.add(t.point),Y.state.pencilArgs.shake&&k.path.simplify(),v.add(new y({path:k.path})),k.path=null,k.show&&k.show.remove(),k.show=null},z=function(){},O=function(){k.show&&k.show.remove(),k.show=null},_=new n.a.Tool;_.onMouseDown=x,_.onMouseDrag=S,_.onMouseUp=j,_.onMouseMove=$,_.onToggleIn=z,_.onToggleOut=O;var T={path:null,show:null},L={lastSize:0},A=function(t){T.show&&T.show.layer===n.a.project.activeLayer&&L.layer===Y.state.eraserArgs.size||(T.show&&T.show.remove(),T.show=null,T.show=new n.a.Path.Circle({center:[0,0],radius:Y.state.eraserArgs.size/2,strokeColor:"black",fillColor:"white"}),L.lastSize=Y.state.eraserArgs.size),T.show.position=t.point},M=function(t){T.path=new n.a.Path,T.path.strokeColor="white",T.path.strokeWidth=Y.state.eraserArgs.size,T.path.blendMode="destination-out",T.path.strokeCap="round",T.path.strokeJoin="round",T.path.add(t.point)},D=function(t){T.show&&(T.show.position=t.point,T.show.bringToFront()),T.path&&T.path.add(t.point)},P=function(t){T.path.add(t.point),v.add(new y({path:T.path})),T.path=null},E=function(){},N=function(){T.show&&T.show.remove(),T.show=null},I=new n.a.Tool;I.onMouseDown=M,I.onMouseDrag=D,I.onMouseUp=P,I.onMouseMove=A,I.onToggleIn=E,I.onToggleOut=N;var B={prevSelection:null};function V(){if(B.prevSelection){var t=B.prevSelection.path||B.prevSelection;t.bounds.selected=!1,t.selected=!1,B.prevSelection.selected=!1,B.prevSelection=null}}var H=function(t){V();var e=n.a.project.hitTest(t.point,{tolerance:4,fill:!0,stroke:!0,segments:!0}),s=e&&e.item;if(s){var o="segment"===e.type;s.bounds.selected=!o,o&&(s=e.segment),s.selected=!0}B.prevSelection=s},R=function(){V()},W=new n.a.Tool;W.onMouseDown=H,W.onToggleOut=R;var U={path:null,carryLength:0},F=function(){U.path=new n.a.Path,U.path.fillColor=Y.state.brushArgs.color},J=function(t){if(U.path&&t.delta.length>1){var e=t.delta;e.angle=e.angle+90;var s=e.normalize().multiply(Y.state.brushArgs.size).multiply(1/e.length),o=t.middlePoint.add(s),a=t.middlePoint.subtract(s);U.carryLength=U.carryLength+e.length,U.carryLength>s.length&&(U.path.add(o),U.path.insert(0,a),U.path.smooth(),U.carryLength=0)}},q=function(){Y.state.brushArgs.shake&&U.path.simplify(),v.add(new y({path:U.path})),U.path=null},X=function(){},G=function(){},K=new n.a.Tool;K.onMouseDown=F,K.onMouseDrag=J,K.onMouseUp=q,K.onToggleIn=X,K.onToggleOut=G;var Q={pencil:_,eraser:I,select:W,brush:K};o["default"].use(d["a"]);var Y=new d["a"].Store({state:{image:"",capture:"",drawing:"",plant:{name:"",data:{}},toolName:null,canvasArgs:{bgColor:"#fff"},pencilArgs:{color:"#000000",size:10,shake:!0},eraserArgs:{size:20},brushArgs:{color:"#000000",size:20,shake:!0},drawSession:{step:0,description:""}},mutations:{reset:function(t){t.image="",t.capture="",t.drawing="",t.plant.name="",t.plant.data={},t.drawSession.step=0,t.drawSession.description=""},setImage:function(t,e){t.image=e},setCapture:function(t,e){t.capture=e},setDrawing:function(t,e){t.drawing=e},setPlant:function(t,e){t.plant.name=e},setPlantData:function(t,e){t.plant.data=e},setStep:function(t){t.drawSession.step<1&&t.drawSession.step++},setDescription:function(t,e){t.drawSession.description=e},setTool:function(t,e){t.toolName&&Q[t.toolName].onToggleOut&&Q[t.toolName].onToggleOut(),t.toolName=e,Q[e]&&(Q[e].activate(),Q[e].onToggleIn&&Q[e].onToggleIn())},setArgs:function(t,e){var s=e.toolName,o=e.color,a=e.size,n=e.shake,i=t[s+"Args"];i.color=o||i.color,i.size=a||i.size,void 0!==n&&(i.shake=n)},setCanvasArgs:function(t,e){Object.assign(t.canvasArgs,e)}},actions:{},modules:{}}),Z=s("e37d"),tt=(s("b972"),s("8c4f")),et=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"container"}},[s("div",{staticClass:"z-50 absolute bottom-12 left-1/2 transform -translate-x-1/2"},[s("a",{ref:"classification",staticClass:"text",attrs:{id:"classification"}})]),s("div",{ref:"toCanvas",staticClass:"z-50 absolute bottom-6 right-12 hidden"},[s("router-link",{staticClass:"mx-6",attrs:{to:"/canvas"}},[s("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/next.svg"}})])],1),t._m(0),s("div",{ref:"capture"},[s("VCapture",{staticClass:"z-50 absolute top-1/2 right-5 transform -translate-y-1/2",on:{click:function(e){return t.onCapture()}}})],1),t._m(1),s("div",{ref:"clear",staticClass:"z-50 absolute w-80 h-80 left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 hidden",on:{click:function(e){return t.clear()}}}),s("div",{ref:"canvasWrapper",staticClass:"z-0 overflow-hidden hidden absolute bottom-0"},[s("canvas",{ref:"canvas",attrs:{id:"canvas"}})]),s("div",{staticClass:"z-0 overflow-hidden absolute bottom-0"},[s("video",{ref:"video",attrs:{width:t.windowWidth,height:t.windowHeight,id:"video",playsinline:"",autoplay:""}})])])},st=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"z-50 absolute top-12 left-1/2 transform -translate-x-1/2"},[s("p",{staticClass:"text"},[t._v("按下快门，和我一起写生吧！")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"z-40 layer"},[s("div",{staticClass:"circle"})])}],ot=s("5530"),at=(s("d3b7"),s("159b"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{on:{click:t.handleClick}},[t._m(0)])}),nt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("i",[s("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/shot.svg"}})])}],it={methods:{handleClick:function(t){this.$emit("click",t)}}},rt=it,ct=Object(c["a"])(rt,at,nt,!1,null,"50c92132",null),lt=ct.exports,ut=[{name:"杜鹃花",type:"被子植物门·双子叶植物纲·杜鹃花目·杜鹃花科·杜鹃属",draw:["我是杜鹃花，一般在春季开花，每簇花2到6朵，花冠漏斗形。叶革质，常集生枝端，卵形、椭圆状卵形或倒卵形或倒卵形至倒披针形。","我有红、淡红、杏红、雪青、白色等不同颜色的品种，花色繁茂艳丽。我的花冠上往往会有一些斑点。我的分枝多而纤细，密被亮棕褐色扁平糙伏毛。","我主要生活在亚洲，常出现在山地疏灌丛或松林下，周围会有很多绿叶，也会有一些小昆虫会出现在我的身边。"],data:["杜鹃（学名：Rhododendron simsii Planch.）：是双子叶植物纲、杜鹃花科、杜鹃属的常绿灌木、落叶灌木。又名映山红、山石榴。相传，古有杜鹃鸟，日夜哀鸣而咯血，染红遍山的花朵，因而得名。杜鹃花一般春季开花，每簇花2-6朵，花冠漏斗形，有红、淡红、杏红、雪青、白色等，花色繁茂艳丽。生于海拔500-1200（-2500）米的山地疏灌丛或松林下，为中国中南及西南典型的酸性土指示植物。","该物种全株供药用：有行气活血、补虚，治疗内伤咳嗽，肾虚耳聋，月经不调，风湿等疾病。又因花冠鲜红色，为著名的花卉植物，具有较高的观赏价值，在世界各公园中均有栽培。中国江西、安徽、贵州以杜鹃花为省花，定为市花的城市多达七八个。1985年5月杜鹃花被评为中国十大名花之六。","原产于东亚，生长在海拔500-2700米的高度。野生物种分布于中国、日本、老挝、缅甸和泰国。"]},{name:"茉莉花",type:"被子植物门·双子叶植物纲·杜鹃花目·杜鹃花科·杜鹃属",draw:["我是杜鹃花，一般在春季开花，每簇花2到6朵，花冠漏斗形。叶革质，常集生枝端，卵形、椭圆状卵形或倒卵形或倒卵形至倒披针形。","我有红、淡红、杏红、雪青、白色等不同颜色的品种，花色繁茂艳丽。我的花冠上往往会有一些斑点。我的分枝多而纤细，密被亮棕褐色扁平糙伏毛。","我主要生活在亚洲，常出现在山地疏灌丛或松林下，周围会有很多绿叶，也会有一些小昆虫会出现在我的身边。"],data:["杜鹃（学名：Rhododendron simsii Planch.）：是双子叶植物纲、杜鹃花科、杜鹃属的常绿灌木、落叶灌木。又名映山红、山石榴。相传，古有杜鹃鸟，日夜哀鸣而咯血，染红遍山的花朵，因而得名。杜鹃花一般春季开花，每簇花2-6朵，花冠漏斗形，有红、淡红、杏红、雪青、白色等，花色繁茂艳丽。生于海拔500-1200（-2500）米的山地疏灌丛或松林下，为中国中南及西南典型的酸性土指示植物。","该物种全株供药用：有行气活血、补虚，治疗内伤咳嗽，肾虚耳聋，月经不调，风湿等疾病。又因花冠鲜红色，为著名的花卉植物，具有较高的观赏价值，在世界各公园中均有栽培。中国江西、安徽、贵州以杜鹃花为省花，定为市花的城市多达七八个。1985年5月杜鹃花被评为中国十大名花之六。","原产于东亚，生长在海拔500-2700米的高度。野生物种分布于中国、日本、老挝、缅甸和泰国。"]}],ht={components:{VCapture:lt},data:function(){return{video:"",imgData:"",canvas:"",context:"",scale:1,sketch:new Image,windowWidth:1194,windowHeight:897}},computed:Object(ot["a"])({},Object(d["b"])(["capture","plant"])),methods:{errorHandler:function(t){console.log("navigator.getUserMedia error: ",t)},gotStream:function(t){return window.stream=t,this.video.srcObject=t,navigator.mediaDevices.enumerateDevices()},start:function(){window.stream&&window.stream.getTracks().forEach((function(t){t.stop()}));var t={video:{facingMode:"environment"}};navigator.mediaDevices.getUserMedia(t).then(this.gotStream).catch(this.errorHandler)},onCapture:function(){document.getElementById("classification").innerHTML="",this.$refs.capture.classList.toggle("hidden"),this.$refs.canvasWrapper.classList.toggle("hidden"),this.$refs.clear.classList.toggle("hidden"),this.video.classList.toggle("hidden"),this.context.drawImage(this.video,0,0,this.canvas.width/this.scale,this.canvas.height/this.scale),this.imgData=this.canvas.toDataURL("image/jpeg"),this.$store.commit("setCapture",this.imgData),this.onConfirm()},onConfirm:function(){var t=new XMLHttpRequest;t.open("POST","https://ztodesign.cn:5000/photo2sketch",!0),t.setRequestHeader("cache-control","no-cache");var e=new FormData;e.append("image",this.imgData);var s=this;t.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE&&200===this.status){var e=JSON.parse(t.responseText);if(s.$refs.toCanvas.classList.toggle("hidden"),document.getElementById("classification").innerHTML=e.data.class,e)if("非植物"===e.data.class){s.$store.commit("setImage",e.data.resImage),s.$store.commit("setPlant","杜鹃花");for(var o=0;o<ut.length;o++)s.plant.name===ut[o].name&&s.$store.commit("setPlantData",ut[o])}else{s.$store.commit("setImage",e.data.resImage),s.$store.commit("setPlant",e.data.class);for(var a=0;a<ut.length;a++)s.plant.name===ut[a].name&&s.$store.commit("setPlantData",ut[a])}}},t.send(e)},clear:function(){this.$refs.capture.classList.toggle("hidden"),this.$refs.canvasWrapper.classList.toggle("hidden"),this.$refs.toCanvas.classList.toggle("hidden"),this.video.classList.toggle("hidden"),this.$refs.clear.classList.toggle("hidden")}},mounted:function(){document.body.addEventListener("touchmove",(function(t){t.preventDefault()}),{passive:!1}),this.windowWidth=document.documentElement.clientWidth,this.windowHeight=this.windowWidth/4*3,this.video=this.$refs.video,this.canvas=this.$refs.canvas,this.context=this.canvas.getContext("2d"),this.scale=window.devicePixelRatio,this.canvas.width=Math.floor(this.windowWidth),this.canvas.height=Math.floor(this.windowHeight),this.context.scale(this.scale,this.scale);var t=this;this.sketch.onload=function(){t.context.drawImage(this,0,0,t.canvas.width/t.scale,t.canvas.height/t.scale)},navigator.mediaDevices.enumerateDevices().catch(this.errorHandler),this.start()}},dt=ht,pt=(s("667b"),Object(c["a"])(dt,et,st,!1,null,"126c9f99",null)),ft=pt.exports,mt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"canvas default w-full h-full flex flex-col justify-between items-center overflow-hidden"},[s("div",{staticClass:"absolute flex flex-row justify-between items-center bg-white rounded-b-2xl"},[s("VHeader")],1),s("canvas",{ref:"canvas",staticClass:"w-full h-screen",style:t.cursor+t.canvasBg,attrs:{id:"canvas",resize:""}}),s("VDialogue",{ref:"sidebar",staticClass:"absolute top-1/2 left-0 transform -translate-y-2/3 transition duration-500 ease-in-out",on:{click:t.toggleSideBar}}),s("VNext",{staticClass:"absolute bottom-12 right-12",on:{click:t.exportSvg}})],1)},vt=[],gt=(s("b680"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex items-center justify-center flex-wrap w-96 h-20"},[s("VPicker",{staticClass:"transform -translate-y-2"}),s("VTools",{staticClass:"transform -translate-y-2"})],1)}),bt=[],wt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex items-center gap-x-10"},[s("v-popover",{attrs:{disabled:t.disabledSize,offset:"16"}},[s("VIconBtn",{ref:"pencil",staticClass:"transform -translate-y-5 transition duration-300 ease-in-out",attrs:{title:"画笔(P)",active:"pencil"===t.toolName,name:"pencil"},on:{click:function(e){return t.setTool("pencil")}}}),s("template",{slot:"popover"},[s("div",{staticClass:"v-size-picker"},[s("VueSlider",{attrs:{min:1},model:{value:t.size,callback:function(e){t.size=e},expression:"size"}})],1)])],2),s("v-popover",{attrs:{disabled:t.disabledSize,offset:"16"}},[s("VIconBtn",{ref:"brush",staticClass:"transform -translate-y-5 transition duration-300 ease-in-out",attrs:{title:"刷子(B)",active:"brush"===t.toolName,name:"brush"},on:{click:function(e){return t.setTool("brush")}}}),s("template",{slot:"popover"},[s("div",{staticClass:"v-size-picker"},[s("VueSlider",{attrs:{min:1},model:{value:t.size,callback:function(e){t.size=e},expression:"size"}})],1)])],2),s("v-popover",{attrs:{disabled:t.disabledSize,offset:"16"}},[s("VIconBtn",{attrs:{title:"擦除(E)",active:"eraser"===t.toolName,name:"eraser"},on:{click:function(e){return t.setTool("eraser")}}}),s("template",{slot:"popover"},[s("div",{staticClass:"v-size-picker"},[s("VueSlider",{attrs:{min:1},model:{value:t.size,callback:function(e){t.size=e},expression:"size"}})],1)])],2)],1)},yt=[],kt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{on:{click:t.handleClick}},[s("i",[s("img",{attrs:{src:t.src,alt:t.name}})])])},Ct=[],$t={props:{active:Boolean,disabled:Boolean,name:String},computed:{src:function(){return"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/"+this.name+".svg"}},methods:{handleClick:function(t){this.disabled||this.$emit("click",t)}}},xt=$t,St=Object(c["a"])(xt,kt,Ct,!1,null,"6cc9eac0",null),jt=St.exports,zt=s("4971"),Ot=s.n(zt),_t=(s("8445"),{components:{VIconBtn:jt,VueSlider:Ot.a},data:function(){return{size:1}},computed:{toolName:function(){return this.$store.state.toolName},toolArgs:function(){return this.$store.state[this.toolName+"Args"]||{}},disabledSize:function(){return null===this.toolName}},watch:{toolName:function(){this.toolArgs.size&&(this.size=this.toolArgs.size)},size:function(){this.toolArgs.size&&this.$store.commit("setArgs",{toolName:this.toolName,size:this.size})}},methods:{setTool:function(t){"pencil"===t?(this.$refs["brush"].$el.classList.remove("translate-y-2"),this.$refs["brush"].$el.classList.add("-translate-y-5"),this.$refs["pencil"].$el.classList.remove("-translate-y-5"),this.$refs["pencil"].$el.classList.add("translate-y-2")):"brush"===t?(this.$refs["pencil"].$el.classList.remove("translate-y-2"),this.$refs["pencil"].$el.classList.add("-translate-y-5"),this.$refs["brush"].$el.classList.remove("-translate-y-5"),this.$refs["brush"].$el.classList.add("translate-y-2")):"eraser"===t&&(this.$refs["brush"].$el.classList.remove("translate-y-2"),this.$refs["brush"].$el.classList.add("-translate-y-5"),this.$refs["pencil"].$el.classList.remove("translate-y-2"),this.$refs["pencil"].$el.classList.add("-translate-y-5")),this.$store.commit("setTool",t)}},mounted:function(){this.$refs["brush"].$el.classList.remove("translate-y-2"),this.$refs["brush"].$el.classList.add("-translate-y-5"),this.$refs["pencil"].$el.classList.remove("-translate-y-5"),this.$refs["pencil"].$el.classList.add("translate-y-2")}}),Tt=_t,Lt=(s("dd7d"),Object(c["a"])(Tt,wt,yt,!1,null,"568dea9a",null)),At=Lt.exports,Mt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex pr-10"},[s("v-popover",{attrs:{disabled:t.disabledColor,offset:"16"}},[s("VIconBtn",{attrs:{disabled:t.disabledColor,title:"颜色",color:t.color,name:"color"}}),s("template",{slot:"popover"},[s("CompactPicker",{model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1)],2)],1)},Dt=[],Pt=s("c345"),Et={components:{VIconBtn:jt,CompactPicker:Pt["Compact"]},data:function(){return{color:"#000000"}},computed:Object(ot["a"])(Object(ot["a"])({},Object(d["b"])(["toolName"])),{},{toolArgs:function(){return this.$store.state[this.toolName+"Args"]||{}},disabledColor:function(){return null===this.toolName||"eraser"===this.toolName}}),watch:{toolName:function(){this.toolArgs.color&&(this.color=this.toolArgs.color)},color:function(){this.toolArgs.color&&this.$store.commit("setArgs",{toolName:this.toolName,color:this.color.hex8})}}},Nt=Et,It=Object(c["a"])(Nt,Mt,Dt,!1,null,"2169a79e",null),Bt=It.exports,Vt=function(t){t||(t=w()());var e=new n.a.Layer({name:t});return n.a.project.addLayer(e),e},Ht=function(){return n.a.project.clear(),v.clear(),n.a.project},Rt=s("9b6a"),Wt={components:{VTools:At,VIconBtn:jt,VPicker:Bt},data:function(){return{history:v}},mounted:function(){Object(Rt["a"])("ctrl+s",this.exportSvg),Object(Rt["a"])("f1",this.help)},methods:{clear:function(){Ht(),Vt()},undo:function(){v.undo()},redo:function(){v.redo()}}},Ut=Wt,Ft=Object(c["a"])(Ut,gt,bt,!1,null,"68e5754c",null),Jt=Ft.exports,qt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"test",staticClass:"dialogue-wrapper flex flex-row bg-white rounded-r-2xl"},[s("img",{staticClass:"pl-6",attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/line.svg"}}),s("div",{staticClass:"flex flex-col justify-between items-center",on:{click:t.handleClick}},[t._m(0),s("img",{staticClass:"m-12",attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/len.svg"},on:{click:function(e){return t.$emit("toggleMagnifier")}}})])])},Xt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pt-6"},[s("p",{staticClass:"dialogue"},[s("span",[t._v("你好呀，小朋友! 让我们开始写生吧！画完后点击下一步可以查看该植物的完整信息哦。")])])])}];s("a15b"),s("3ca3"),s("ddb0"),s("2b3d"),s("9861");function Gt(t,e){var s="https://tsn.baidu.com/text2audio",o=e||{},a=t||{},n=document.createElement("audio");o.autoplay&&n.setAttribute("autoplay","autoplay"),o.hidden?n.style.display="none":n.setAttribute("controls","controls"),"undefined"!==typeof o.volume&&(n.volume=o.volume),f(o.onInit)&&o.onInit(n);var i=6e4,r=o.timeout||i,c=new XMLHttpRequest;c.open("POST",s);var l={};for(var a in t)l[a]=t[a];l.cuid=l.cuid||l.tok,l.ctp=1,l.lan=l.lan||"zh",l.aue=l.aue||3;var u=[];for(var h in l)u.push(h+"="+encodeURIComponent(l[h]));var d=new FileReader;c.responseType="blob",c.send(u.join("&"));var p=setTimeout((function(){c.abort(),f(o.onTimeout)&&o.onTimeout()}),r);function f(t){return"[object Function]"===Object.prototype.toString.call(t)}c.onreadystatechange=function(){4==c.readyState&&(clearTimeout(p),200==c.status&&("audio/mp3"===c.response.type&&(document.body.appendChild(n),n.setAttribute("src",URL.createObjectURL(c.response)),o.autoDestory&&(n.onended=function(){document.body.removeChild(n)}),f(o.onSuccess)&&o.onSuccess(n)),"application/json"===c.response.type&&(d.onload=function(){var t=d.result;f(o.onError)&&o.onError(t)},d.readAsText(c.response))))}}function Kt(t){console.log(t),Gt({tex:t,tok:"25.460eac2eaa96064987fb7d42b0bdebd9.315360000.1953616249.282335-24318664",spd:5,pit:5,vol:15,per:103},{volume:.3,autoDestory:!0,timeout:1e4,hidden:!0,autoplay:!0})}var Qt={methods:{handleClick:function(t){this.$emit("click",t)}},watch:{content:function(t){Kt(t)}},mounted:function(){this.$refs.test.click(),Kt("你好呀，小朋友! 让我们开始写生吧！画完后点击下一步可以查看该植物的完整信息哦。")}},Yt=Qt,Zt=(s("f2c3"),Object(c["a"])(Yt,qt,Xt,!1,null,"421f5c28",null)),te=Zt.exports,ee=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{on:{click:t.handleClick}},[s("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/next.svg"}})])},se=[],oe={methods:{handleClick:function(t){this.$router.push({path:"/plant"}),this.$emit("click",t)}}},ae=oe,ne=Object(c["a"])(ae,ee,se,!1,null,"eae2ffde",null),ie=ne.exports,re=function(t){Object(Rt["a"])("b",(function(){return Y.commit("setTool","brush")})),Object(Rt["a"])("p",(function(){return Y.commit("setTool","pencil")})),Object(Rt["a"])("e",(function(){return Y.commit("setTool","eraser")})),Object(Rt["a"])("a",(function(){return Y.commit("setTool","select")})),Object(Rt["a"])("ctrl+z",(function(){return v.undo()})),Object(Rt["a"])("ctrl+shift+z",(function(){return v.redo()})),Object(Rt["a"])("ctrl+q",(function(){Ht(),Vt()}))},ce=function(t){n.a.setup(t.canvas),n.a.tool=null,re(t),document.getElementById("canvas").addEventListener("wheel",(function(e){t.vdrawArgs.zoom=n.a.view.zoom})),n.a.project.importJSON(window.localStorage.vdarw||[]),t.vdrawArgs.size=n.a.view.size,t.vdrawArgs.zoom=n.a.view.zoom,t.isInit=!0},le={components:{VHeader:Jt,VDialogue:te,VNext:ie},data:function(){return{isInit:!1,vdrawArgs:{size:{width:0,height:0},zoom:0},svg:""}},methods:{toggleSideBar:function(){this.$refs["sidebar"].$el.classList.toggle("-translate-x-44")},exportSvg:function(){console.log("exportSvg");var t=paper.project.exportSVG(),e=btoa((new XMLSerializer).serializeToString(t)),s="data:image/svg+xml;base64,"+e;this.$store.commit("setDrawing",s)}},computed:{cursor:function(){var t=this.$store.state.toolName;return null===t||"brush"===t?"cursor: auto;":"select"!==t?"cursor: none;":"cursor: auto;"},canvasBg:function(){return"background-color: ".concat(this.$store.state.canvasArgs.bgColor,"fa;")},canvas:function(){return this.$refs.canvas}},mounted:function(){ce(this),Ht(),Vt(),this.$store.commit("setTool","pencil")},filters:{toFixed:function(t){return t.toFixed(2)}}},ue=le,he=(s("dcd9"),Object(c["a"])(ue,mt,vt,!1,null,null,null)),de=he.exports,pe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"plant w-screen h-screen"},[s("router-link",{staticClass:"absolute top-11 left-14",attrs:{to:"/"}},[s("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/back.svg"},on:{click:t.toHome}})]),s("div",{staticClass:"px-16 pt-36 flex flex-row justify-between items-top"},[s("div",{staticClass:"relative"},[s("div",{staticClass:"w-64 h-64 overflow-hidden border-8 border-yellow-400 rounded-full"},[s("img",{staticClass:"image",attrs:{src:t.capture}})]),s("div",{staticClass:"bg-white absolute w-80 h-80 left-24 top-40 overflow-hidden border-8 border-yellow-400 rounded-full"},[s("div",{staticClass:"image absolute w-80 h-80 overflow-hidden"},[s("img",{staticClass:"absolute top-2",attrs:{src:t.drawing}})])])]),s("div",{staticClass:"text pl-52 pr-24"},[s("div",{staticClass:"flex flex-row justify-start items-center pb-6"},[s("h1",{staticClass:"text-5xl pr-8",staticStyle:{color:"#14B9F4"}},[t._v(t._s(t.plant.data.name))]),s("div",{staticClass:"pb-2",on:{click:function(e){return t.onAudioPlay()}}},[s("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/trump.svg"}})])]),s("h2",{staticClass:"text-3xl pb-4 text-gray-900"},[t._v(t._s(t.plant.data.type))]),s("VScroll",{staticClass:"h-72 overflow-hidden",attrs:{data:t.plantData}},[s("div",{staticClass:"text-lg text-gray-900",attrs:{id:"desc"}})])],1)])],1)},fe=[],me=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{on:{click:t.handleClick}},[s("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/trump.svg"}})])},ve=[],ge={computed:Object(ot["a"])({},Object(d["b"])(["drawSession"])),methods:{handleClick:function(t){Kt(this.drawSession.description),this.$emit("click",t)}}},be=ge,we=Object(c["a"])(be,me,ve,!1,null,"0d3f0be0",null),ye=we.exports,ke=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"scrollWrapper",staticClass:"scroll"},[t._t("default")],2)},Ce=[],$e=s("f40f"),xe={name:"scroll",data:function(){return{}},props:{data:{type:String,default:function(){return""}}},watch:{data:function(t){var e=this;this.$nextTick((function(){e.refresh()}))}},mounted:function(){var t=this;this.$nextTick((function(){t.initScroll()}))},methods:{initScroll:function(){this.$refs.scrollWrapper&&(this.scroll=new $e["a"](this.$refs.scrollWrapper,{click:!0}))},refresh:function(){this.scroll&&this.scroll.refresh()},scrollToElement:function(){this.scroll&&this.scroll.scrollToElement.apply(this.scroll,arguments)},scrollTo:function(){this.scroll&&this.scroll.scrollTo.apply(this.scroll,arguments)}}},Se=xe,je=Object(c["a"])(Se,ke,Ce,!1,null,"44967700",null),ze=je.exports,Oe={data:function(){return{plantData:""}},components:{VScroll:ze,VTrump:ye},computed:Object(ot["a"])({},Object(d["b"])(["capture","drawing","plant"])),methods:{toHome:function(){this.$store.commit("reset")},onAudioPlay:function(){Kt(this.plantData)}},mounted:function(){var t=document.getElementById("desc");t.innerHTML="";for(var e=0;e<this.plant.data.data.length;e++)t.innerHTML+=this.plant.data.data[e],this.plantData+=this.plant.data.data[e],t.innerHTML+="</br>",t.innerHTML+="</br>"}},_e=Oe,Te=(s("fc06"),Object(c["a"])(_e,pe,fe,!1,null,"33feac06",null)),Le=Te.exports;o["default"].use(tt["a"]);var Ae=[{path:"/",name:"Home",component:ft},{path:"/canvas",name:"Canvas",component:de},{path:"/plant",name:"Plant",component:Le}],Me=new tt["a"]({mode:"hash",base:"",routes:Ae}),De=Me,Pe=s("28dd");n.a.install(window),o["default"].prototype.$store=Y,o["default"].config.productionTip=!1,o["default"].use(Z["a"]),o["default"].use(Pe["a"]);e["default"]=new o["default"]({store:Y,router:De,render:function(t){return t(h)}}).$mount("#app")},"5baf":function(t,e,s){},"667b":function(t,e,s){"use strict";var o=s("e0bd"),a=s.n(o);a.a},"925d":function(t,e,s){},b9af:function(t,e,s){},dcd9:function(t,e,s){"use strict";var o=s("925d"),a=s.n(o);a.a},dd7d:function(t,e,s){"use strict";var o=s("1309"),a=s.n(o);a.a},e0bd:function(t,e,s){},f2c3:function(t,e,s){"use strict";var o=s("5baf"),a=s.n(o);a.a},fc06:function(t,e,s){"use strict";var o=s("b9af"),a=s.n(o);a.a}});
//# sourceMappingURL=app.9dcb8cc2.js.map